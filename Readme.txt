ちょっと設計から考えます。各オブジェクトのつながりが強すぎてまずいことになってる。
